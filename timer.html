<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study Timer</title>
<style>
    body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; }
    #timer { font-size: 48px; margin: 20px; }
    .button-container { display: flex; justify-content: center; }
    button { margin: 5px; padding: 5px; font-size: 14px; }
    .counters-container {
    display: flex;
    justify-content: center;
    gap: 10px; /* Adjust the gap between counters as needed */
}
  </style>
</head>
<body>
    <div class="counters-container">
        <div id="sessionCounter">0/4</div>
        <div id="cycleCounter">0/3</div>
    </div>
    <div id="timer">25:00</div>
<div class="button-container">
    <button id="startStudy">Focus</button>
    <button id="startShortBreak">Short Break</button>
    <button id="startLongBreak">Long Break</button>
    <button id="stopTimer" style="display:none;">Stop Timer</button> <!-- Added Stop Timer button -->
    <button id="stopAlarm" style="display:none;">Stop Alarm</button>
  </div>
<audio id="alarmSound" src="alarm.wav"></audio>

<script>
    const studyDuration = 25 * 60;
    const shortBreakDuration = 5 * 60;
    const longBreakDuration = 15 * 60;
    let countdown;
    let timeLeft = studyDuration;
    let studySessionCounter = 0;
    let cycleCounter = 0;
    
    function updateTimerDisplay(seconds) {
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = seconds % 60;
      document.getElementById('timer').textContent = `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
    }
    
    function updateSessionCounter() {
      if (studySessionCounter < 4) {
        studySessionCounter++;
      } else {
        studySessionCounter = 1;
        updateCycleCounter();
      }
      document.getElementById('sessionCounter').textContent = `${studySessionCounter}/4`;
    }
    
    function updateCycleCounter() {
      if (cycleCounter < 3) {
        cycleCounter++;
      } else {
        cycleCounter = 0;
      }
      document.getElementById('cycleCounter').textContent = `${cycleCounter}/3`;
    }
    
    function startTimer(duration) {
      document.querySelector('.button-container').style.display = 'none';
      document.getElementById('stopTimer').style.display = 'block'; // Show Stop Timer button

      if (duration === studyDuration) {
        updateSessionCounter();
      }
      clearInterval(countdown);
      let time = duration;
      updateTimerDisplay(time);
      countdown = setInterval(() => {
        time--;
        updateTimerDisplay(time);
        if (time <= 0) {
          clearInterval(countdown);
          document.getElementById('alarmSound').play();
          document.getElementById('stopAlarm').style.display = 'block';
          document.getElementById('stopTimer').style.display = 'none'; // Hide Stop Timer button
        }
      }, 1000);
    }
    
    document.getElementById('startStudy').addEventListener('click', () => startTimer(studyDuration));
    document.getElementById('startShortBreak').addEventListener('click', () => startTimer(shortBreakDuration));
    document.getElementById('startLongBreak').addEventListener('click', () => startTimer(longBreakDuration));
    
    document.getElementById('stopAlarm').addEventListener('click', () => {
      document.getElementById('alarmSound').pause();
      document.getElementById('alarmSound').currentTime = 0;
      document.getElementById('stopAlarm').style.display = 'none';
    });

    document.getElementById('stopTimer').addEventListener('click', () => {
      clearInterval(countdown);
      document.querySelector('.button-container').style.display = 'flex'; // Show all buttons
      document.getElementById('stopTimer').style.display = 'none'; // Hide Stop Timer button
      updateTimerDisplay(studyDuration); // Reset timer display
    });

    document.body.addEventListener('click', (event) => {
        // Check if the target is not one of the buttons to avoid hiding them when clicked
        if (!event.target.matches('button')) {
            const buttonContainer = document.querySelector('.button-container');
            if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
                buttonContainer.style.display = 'flex'; // Show all buttons
            }
        }
    });

    // Modify existing button event listeners to stop propagation
    document.querySelectorAll('button').forEach(button => {
        button.addEventListener('click', (event) => {
            event.stopPropagation(); // Prevent the body click event from being triggered
        });
    });
</script>
</body>
</html>